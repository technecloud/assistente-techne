"use strict";(function(a,b){a.Navegg=a.Navegg||function(b){a.Navegg.q.push([this,b]);};a.Navegg.q=a.Navegg.q||[];var c=a.Navegg.prototype;c.say=function(a,b){switch(a){case 'i':console.info(b);break;case 'w':console.warn(b);break;case 'e':console.error(b);break;}return undefined;};c.getServerDomain=function(a){return 'https://'+a+'.navdmp.com';};c.__cleanConfigCache=function(){this.say('w','nvg'+this.acc+'config cache cleaned');a.localStorage.removeItem('nvgcnfg'+this.acc);};c.include=function(a,c,d,e,f){if(c==''||c==undefined)c="script";if(e===''||e===undefined)e=true;var g=b.createElement(c);if(c=='script')g.type="text/javascript";if(!a&&d)d='try{'+d+'}catch(e){console.error(e);nvg'+this.acc+'.__cleanConfigCache();}';if(d)g.text=d;else{g.src=a;if(c=="img")g.style.display='none';}if(f)g.onerror=f.bind(this);g.async=e;var h=b.getElementsByTagName('script')[0];h.parentNode.insertBefore(g,h);};c.getTLD=function(){var b,c,d="",e,f,g,h,i;i='nvgTLD'+this.account;f=new Date();h=f.getTime();b=a.localStorage.getItem('nvgTLD');if(b)return b;c=a.location.hostname.split(".");for(e=c.length-1;e>0;e--){d="."+c[e]+d;f.setTime(f.getTime()+5*1000);document.cookie=i+'='+h+';expires='+(f.toGMTString())+';domain='+d;g=this.getCookie(i);if(g==h){a.localStorage.setItem('nvgTLD',d);f=new Date();document.cookie=i+'='+h+';expires='+(f.toGMTString())+';domain='+d;return d;}}return '.'+a.location.hostname;};c.setCustom=function(a){var b={};b.acc=this.acc;if(this.usr)b.id=this.usr;b.cus=a;this.include(this.getServerDomain('cdn')+'/cus?'+this.serializeParams(b));this.__setCustomFp(a);};c.setCustomTargeting=function(a,b){var c,d,e,f;for(c=0;c<a.length;c++){e=a[c];f=false;for(d=0;d<e.length;d++)if(window.location.href.search(e[d])>=0)f=true;if(!f)return false;}this.setCustom(b);return true;};c.getParameter=function(b){if(!this.qry){this.qry={};var c=a.location.search.substr(1);var d=c.split("&");for(var e=0;e<d.length;e++){var f=d[e].split("=");this.qry[f[0]]=f[1];};};return this.qry[b]||'';};c.getCookie=function(a){var c=b.cookie.indexOf(a+"=");var d=c+a.length+1;if((!c)&&(a!=b.cookie.substring(0,a.length)))return "";if(c==-1)return "";var e=b.cookie.indexOf(";",d);if(e==-1)e=b.cookie.length;return unescape(b.cookie.substring(d,e));};c.setCookie=function(a,c,d){var e='';if(this.dom)e=';domain='+this.dom;var f=new Date();if(d!=d||!d)d=365*24*60;f.setTime(f.getTime()+(d*60*1000));var d=f.toGMTString();b.cookie=a+"="+c+";expires="+d+";path=/"+e;};c.__loadCustomFp=function(){var b,c='nvgcus'+this.acc;var d=a.localStorage.getItem(c);if(d){d=d.split('-');var e=this.getSegment('custom');e=e.split('-');if(e[0]=="")e=Array();for(b=0;b<d.length;b++)if(e.indexOf(d[b])==-1)e.push(d[b]);this.persona.custom=e.join('-');}};c.__setCustomFp=function(a){var b,c='nvgcus'+this.acc;var d=window.localStorage.getItem(c);if(d){d=d.split('-');if(d.indexOf(a.toString())==-1)d.push(a.toString());d=d.join('-');}else d=a;window.localStorage.setItem(c,d);if(this.persona.custom)b=this.persona.custom.split("-");else b=[];if(b.indexOf(a.toString())==-1)b.push(a.toString());this.persona.custom=b.join('-');};c.loadProfile=function(){var b,c=a.localStorage.getItem(this.ckn),d=a.localStorage.getItem('nvgpersona'+this.account);if(!c)c=this.getCookie(this.ckn);if(!c||!d)return this.callUsr();b=c.split("_");c=b[0];if(c.search(/\|/)>=0){c=c.split("|");this.syn=c[1];c=c[0];}this.usr=c;this.ctrl=b[1];if(b[2])this.parsePersona(b[2]);if(this.ctrl!=this.datestr()||this.debug)return this.callUsr();};c.callCallbacks=function(){function b(a){if(typeof a=="function")try{a();}catch(b){};}function c(a){if(typeof a!="undefined"&&a.length)for(var c=0;c<a.length;c++)b(a[c]);}c.prototype.push=function(a){b(a);};a.naveggReady=new c(a.naveggReady);};c.parsePersona=function(b){var c,d,e=b.split(":");for(c=0;c<=this.seg.length;c++){d=(e[c]||'');if(typeof d=="string")d=d.split('-');if(d.length==1){if(d[0]==''||typeof this.seg[c]=="undefined")continue;this.persona[this.seg[c]]=d[0];}else this.persona[this.seg[c]]=d;}try{if(this.persona.cluster&&!this.persona.everyone)this.persona.everyone=this.persona.cluster;if(this.persona.industry&&!this.persona.everybuyer)this.persona.everybuyer=this.persona.industry;}catch(f){};a.localStorage.setItem('nvgpersona'+this.account,JSON.stringify(this.persona));};c.doSync=function(a){var b=this.getCookie(this.ckn)||'';b=b.split('_');if(b[0].search(/\|/)>=0){b[0]=b[0].split('|');b[0]=b[0][0];}b[0]+='|'+a;b=b.join('_');this.setCookie(this.ckn,b);};c.datestr=function(){var a=new Date();var b=new Date(a.getFullYear(),0,0);var c=a-b;var d=1000*60*60*24;return Math.ceil(c/d).toString();};c.serializeParams=function(a){var b,c=[];for(b in a)c.push(b+'='+encodeURIComponent(a[b]));return c.join('&');};c.profile=function(c,d){var e=false;if(!this.usr)e=true;if(c)this.usr=c;b.cookie=this.ckn+'=; expires=Thu, 01 Jan 1970 00:00:01 GMT;';this.setCookie(this.ckn,[this.usr+'|'+this.syn,this.datestr()].join('_'));a.localStorage.setItem(this.ckn,[this.usr+'|'+this.syn,this.datestr(),d].join('_'));this.parsePersona(d);if(e)this.saveRequest(this.usr);this.__loadCustomFp();};c.callUsr=function(){var a,b={};b.v=this.version;b.acc=this.acc;b.u=1;if(this.usr){b.id=this.usr;if(!this.syn)b.jds=1;}else b['new']=this.isnew=1;if(!this.wst)b.wst=0;if(this.wct)b.wct=1;if(!this.dsy)b.dsy=0;if(this.debug)b.rdn=parseInt(Math.random()*1e8);this.include(this.getServerDomain('usr')+'/usr?'+this.serializeParams(b),undefined,undefined,undefined,this.usrError);};c.usrError=function(){this.say('w','error on usr acc'+this.acc);this.saveRequest();};c.getSegment=function(a){var b;if(a=='everybuyer')a='industry';else if(a=='everyone')a='cluster';b=this.persona[a];if(typeof b=="object")b=b.join('-');return b||'';};c.getCollectionList=function(){var a=this.seg.slice();a=a.filter(function(a){return a!='industry'&&a!='prolook'&&a!='';});a[a.indexOf('cluster')]='everyone';return a;};c.getReqDefaultParms=function(){var a;this.reqParms.v=this.version;this.reqParms.id=this.usr+'|'+this.syn;this.reqParms.acc=this.acc;this.reqParms.tit=escape(this.title||b.title);this.origin&&(this.reqParms.ori=escape(this.origin));if(!this.ctr||(this.ctr!=this.datestr()))this.reqParms.upd=1;if(this.isnew)this.reqParms['new']=1;if(this.url)this.reqParms.url=escape(this.url);if(b.referrer)this.reqParms.ref=escape(b.referrer);if(a=this.getCookie('__utmz'))this.reqParms.utm=escape(a);};c.saveRequest=function(a){a&&(this.reqParms.id=a+'|'+this.syn);this.include(this.getServerDomain('cdn')+'/req?'+this.serializeParams(this.reqParms));this.callCallbacks();};c.config=function(b){this.dsy=true;a.localStorage.setItem('nvgcnfg'+this.acc,JSON.stringify({date:new Date(),cnf:b}));for(var c in b)this[c]=b[c];if(a.location.hostname.search(this.dom)==-1)this.dom='';if(!this.dom)this.dom=this.getTLD();this.syn=0;this.persona={};this.reqParms={};this.loadProfile();this.getReqDefaultParms();this.__loadCustomFp();if(this.ext)for(c=0;c<this.ext.length;c++)eval(this.ext[c]);if(this.tmc)for(c=0;c<this.tmc.length;c++)this.include('','script',this.tmc[c]);if(this.usr&&!this.debug)this.saveRequest();};c.loadCnfg=function(){var b,c=a.localStorage.getItem('nvgcnfg'+this.acc);b=new Date();if(c&&!(this.debug)){c=JSON.parse(c);if(c.date)if((b-new Date(c.date))<=(24*60*60*1000))return this.config(c.cnf);}this.include(this.getServerDomain('tag')+'/u/'+this.acc);};c.__init__=function(b){c.seg="gender age education marital income city region country connection brand product interest career cluster prolook custom industry everybuyer pgender page peducation pmarital pincome".split(" ");b[1]=b[1]||{};if(!('acc' in b[1]))return b[0].say("e","Navegg instance must have 'acc' parameter");if(!a['nvg'+b[1].acc])a['nvg'+b[1].acc]=b[0];for(var d in b[1])b[0][d]=b[1][d];b[0].ckn='nvg'+b[1].acc;b[0].debug=b[0].getParameter('navegg_debug')=='1'?true:false;b[0].loadCnfg();};a.Navegg.q.push=c.__init__;for(var d=0;d<Navegg.q.length;d++){var e=Navegg.q[d];e[0].__init__(e);};})(window,document);